<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 28 April 2015 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="The MyBatis Team" />
    <meta name="Date-Revision-yyyymmdd" content="20150428" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MyBatis-Velocity &#x2013; MyBatis FreeMarker</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>MyBatis FreeMarker</h2>
                </div>
                      </div>
        <div class="pull-right">                  <a href="https://mybatis.github.io/mybatis-3/" id="bannerRight">
                                                                                        <img src="http://mybatis.github.com/images/mybatis-logo.png" />
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 28 April 2015
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.2-SNAPSHOT
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Documentation</li>
                              
      <li class="active">
  
            <a href="#"><i class="none"></i>Getting started</a>
          </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                  
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-down"></i>
        Project Information</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="integration.html" title="Continuous Integration">
          <i class="none"></i>
        Continuous Integration</a>
            </li>
                    
      <li>
  
                          <a href="dependencies.html" title="Dependencies">
          <i class="none"></i>
        Dependencies</a>
            </li>
                    
      <li>
  
                          <a href="dependency-info.html" title="Dependency Information">
          <i class="none"></i>
        Dependency Information</a>
            </li>
                    
      <li>
  
                          <a href="distribution-management.html" title="Distribution Management">
          <i class="none"></i>
        Distribution Management</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><i class="none"></i>About</a>
          </li>
                    
      <li>
  
                          <a href="issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                    
      <li>
  
                          <a href="license.html" title="Project License">
          <i class="none"></i>
        Project License</a>
            </li>
                    
      <li>
  
                          <a href="mail-lists.html" title="Mailing Lists">
          <i class="none"></i>
        Mailing Lists</a>
            </li>
                    
      <li>
  
                          <a href="plugin-management.html" title="Plugin Management">
          <i class="none"></i>
        Plugin Management</a>
            </li>
                    
      <li>
  
                          <a href="plugins.html" title="Project Plugins">
          <i class="none"></i>
        Project Plugins</a>
            </li>
                    
      <li>
  
                          <a href="team-list.html" title="Project Team">
          <i class="none"></i>
        Project Team</a>
            </li>
                    
      <li>
  
                          <a href="source-repository.html" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                    
      <li>
  
                          <a href="project-summary.html" title="Project Summary">
          <i class="none"></i>
        Project Summary</a>
            </li>
              </ul>
        </li>
                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            
  
    <div class="section">
<h2><a name="Introduction"></a>Introduction</h2>
      
<p>
      mybatis-freemarker is a plugin that helps creating big dynamic SQL queries. You can use it selectively, to only queries that need if statmenets or foreach-loops, for example. But it is possible to use this syntax by default too.
      </p>
      
<p>
        If you are not familiar with FreeMarker syntax, you can view
        </p>
<ul>
          
<li>
            <a class="externalLink" href="http://freemarker.org/docs/ref.html">Template Language Reference</a>
          </li>
        </ul>
      
    </div>

    
<div class="section">
<h2><a name="Install"></a>Install</h2>
      
<p>
        mybatis-freemarker is available in <a class="externalLink" href="https://bintray.com/bintray/jcenter">jcenter</a> maven repository. So, if you are using maven, you can add this:
      </p>
      
<div class="source">
<pre>
&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;jcenter&lt;/id&gt;
        &lt;url&gt;http://jcenter.bintray.com&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis.scripting&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-freemarker&lt;/artifactId&gt;
        &lt;version&gt;1.1&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</pre></div>

      
<p>If you are using gradle, you can use this snippet:</p>

      
<div class="source">
<pre>
repositories {
    jcenter()
}

dependencies {
    compile(&quot;org.mybatis.scripting:mybatis-freemarker:1.1&quot;)
}</pre></div>

    </div>

    
<div class="section">
<h2><a name="Install_from_sources"></a>Install from sources</h2>
      
<ul>
        
<li>Checkout the source code</li>
        
<li>Run <tt>mvn install</tt> to build and to automatically install it to your local maven repo</li>
        
<li>Add maven dependency to your project
          
<div class="source">
<pre>
&lt;dependency&gt;
  &lt;groupId&gt;org.mybatis.scripting&lt;/groupId&gt;
  &lt;artifactId&gt;mybatis-freemarker&lt;/artifactId&gt;
  &lt;version&gt;1.2-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</pre></div>
        </li>
      </ul>
    </div>

    
<div class="section">
<h2><a name="Configuring"></a>Configuring</h2>
      
<div class="section">
<h3><a name="Common"></a>Common</h3>
        
<ul>
          
<li>(Optional) Create <tt>mybatis-freemarker.properties</tt> file in your classpath:
            
<div class="source">
<pre>basePackage=sql</pre></div>
            This will define base package to search FreeMarker templates. By default it is empty string, so you will need to provide full path to template every time.
          </li>
        </ul>
      </div>
      
<div class="section">
<h3><a name="XML-driven_mappers"></a>XML-driven mappers</h3>
        
<p>If your are using annotations-driven mappers, you don't need to do anything more. If you are using XML-driven mappers too, you may need to do next steps:</p>
        
<ul>
          
<li>Register the language driver alias in your mybatis configuration file:
            
<div class="source">
<pre>
&lt;configuration&gt;
  ...
  &lt;typeAliases&gt;
    &lt;typeAlias alias=&quot;freemarker&quot; type=&quot;org.mybatis.scripting.freemarker.FreeMarkerLanguageDriver&quot;/&gt;
  &lt;/typeAliases&gt;
  ...
&lt;/configuration&gt;</pre></div>
          </li>
          
<li>(Optional) Set the freemarker as your default scripting language:
            
<div class="source">
<pre>
&lt;configuration&gt;
  ...
  &lt;settings&gt;
      &lt;setting name=&quot;defaultScriptingLanguage&quot; value=&quot;freemarker&quot;/&gt;
  &lt;/settings&gt;
  ...
&lt;/configuration&gt;</pre></div>
          </li>
        </ul>
      </div>
    </div>

    
<div class="section">
<h2><a name="Usage_in_annotations-driven_mappers"></a>Usage in annotations-driven mappers</h2>
      
<p>Just write your queries using FreeMarker syntax:</p>
      
<div class="source">
<pre>
@Lang(FreeMarkerLanguageDriver.class)
@Select(&quot;select * from names where id in (${ids?join(',')})&quot;)
List&lt;Name&gt; findNamesByIds(@Param(&quot;ids&quot;) List&lt;Integer&gt; ids);</pre></div>
      
<p>If any whitespace found inside <tt>@Select</tt> text, it is interpreted as inline script, not template name. It is convenient to avoid creating templates when script is really small. If you have a large SQL script, you can place it in distinct template and write next code:</p>
      
<div class="source">
<pre>
@Lang(FreeMarkerLanguageDriver.class)
@Select(&quot;findName.ftl&quot;)
Name findName(@Param(&quot;n&quot;) String name);</pre></div>
      
<p>Template will be searched in classpath using <tt>basePackage</tt> property that has already been described above.</p>
      
<p><tt>findName.ftl</tt> content can be:</p>
      
<div class="source">
<pre>
SELECT *
FROM names
where firstName = &lt;@p name=&quot;n&quot;/&gt;</pre></div>
      
<p><tt>&lt;@p name=&quot;n&quot;/&gt;</tt> is a custom directive to generate <tt>#{n}</tt> markup.
        This markup further will be passed into MyBatis engine, and it will replace this to <tt>?</tt>-parameter.
        You can't write <tt>#{paramName}</tt> directly, because FreeMarker supports this syntax natively
        (alghough it is deprecated). So, to get <tt>?</tt>-parameters to prepared statements works, you need
        to use <tt>${r&quot;#{paramName}&quot;}</tt> verbose syntax, or this directive. By the way, in XML
        files <tt>${r&quot;#{paramName}&quot;}</tt> is more preferrable because you don't need wrap it using
        <tt>CDATA</tt> statements. In annotations and in external templates <tt>&lt;@p/&gt;</tt>
        directive is more neat.</p>
    </div>

    
<div class="section">
<h2><a name="Usage_in_XML-driven_mappers"></a>Usage in XML-driven mappers</h2>
      
<p>As in annotations, you can write inline scripts or template names.</p>
      
<div class="source">
<pre>
&lt;!-- This is handled by FreeMarker too, because it is included into select nodes AS IS --&gt;
&lt;sql id=&quot;cols&quot;&gt;id, ${r&quot;firstName&quot;}, lastName&lt;/sql&gt;

&lt;select id=&quot;findName&quot; resultType=&quot;org.mybatis.scripting.freemarker.Name&quot; lang=&quot;freemarker&quot;&gt;
    findName.ftl
&lt;/select&gt;

&lt;select id=&quot;findNamesByIds&quot; resultType=&quot;org.mybatis.scripting.freemarker.Name&quot; lang=&quot;freemarker&quot;&gt;
    select &lt;include refid=&quot;cols&quot;/&gt; from names where id in (${ids?join(',')})
&lt;/select&gt;

&lt;!-- It is not very convenient - to use CDATA blocks. Better is to create external template
    or use more verbose syntax: ${r&quot;#{id}&quot;}. --&gt;
&lt;select id=&quot;find&quot; resultType=&quot;org.mybatis.scripting.freemarker.Name&quot; lang=&quot;freemarker&quot;&gt;
    select * from names where id = &lt;![CDATA[ &lt;@p name='id'/&gt;]]&gt; and id = ${id}
&lt;/select&gt;</pre></div>
    </div>

    
<div class="section">
<h2><a name="Prepared_statements_parameters"></a>Prepared statements parameters</h2>
      
<p><tt>&lt;@p/&gt;</tt> directive can be used in two scenarios:</p>
      
<ul>
        
<li>To pass parameters to prepared statements AS IS:
          <tt>&lt;@p name='id'/&gt;</tt> (will be translated to <tt>#{id}</tt>, and value already presents in parameter object)
        </li>
        
<li>
          To pass any value as prepared statements parameter
          <tt>&lt;@p value=someValue/&gt;</tt> will be converted to <tt>#{_p0}</tt>, and
          <tt>_p0</tt> parameter will be automatically added to parameters map.
          It is convenient to use in loops like this:
          
<div class="source">
<pre>
select * from names where firstName in (
    &lt;#list ids as id&gt;
        &lt;@p value=id/&gt;
        &lt;#if id_has_next&gt;,&lt;/#if&gt;
    &lt;/#list&gt;
)</pre></div>
          This markup will be translated to
          
<div class="source">
<pre>select * from names where firstName in (#{_p0}, #{_p1}, #{_p2})</pre></div>
          and there are no need to care about escaping. All this stuff will be done automatically by JDBC driver.
          Unfortunately, you can't use this syntax if passing one object as parameter and without
          <tt>@Param</tt> annotation. The <tt>UnsupportedOperationException</tt> will be thrown.
          It is because appending additional parameters to some object in general is very hard.
          When you are using <tt>@Param</tt> annotated args, MyBatis will use <tt>Map</tt> to store parameters,
          and it is easy to add some generated params. So, if you want to use auto-generated prepared
          parameters, please don't forget about <tt>@Param</tt> annotation.
        </li>
      </ul>
    </div>

    
<div class="section">
<h2><a name="Examples"></a>Examples</h2>
      
<p>You can view full-featured example of configuring and of both XML-mapper and annotations-driven mapper usage
        in <a class="externalLink" href="https://github.com/elw00d/mybatis-freemarker/tree/master/src/test">test suite</a></p>
    </div>
  

                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2010&#x2013;2015
                        <a href="http://www.mybatis.org/">MyBatis.org</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
